import{S as Y,i as ee,s as te,w as L,x as R,y as N,f as H,t as U,z as V,o as se,k as y,l as $,m as b,h as f,n as q,b as v,B as ie,q as w,a as O,r as I,c as T,R as ae,G as x,T as X,L as W,P as re,U as oe,J as ne}from"../../../chunks/index-eac81cc4.js";import{M as ce,F as he,S as Z,T as fe,a as le}from"../../../chunks/Footer-e049357b.js";import{S as xe}from"../../../chunks/Seo-593c0eb7.js";import{D as pe}from"../../../chunks/DemoContainer-367e056c.js";function de(p){let t;return{c(){t=y("canvas"),this.h()},l(n){t=$(n,"CANVAS",{slot:!0,class:!0}),b(t).forEach(f),this.h()},h(){q(t,"slot","canvas"),q(t,"class","svelte-nzknsg")},m(n,i){v(n,t,i),p[6](t)},p:ie,d(n){n&&f(t),p[6](null)}}}function ue(p){let t,n,i,l,o,s,r,d,u,E,k,z,D,_,S,A,K,P,M,c;return{c(){t=y("fieldset"),n=y("div"),i=y("label"),l=w("ROM"),o=O(),s=y("select"),r=y("option"),d=w("IBM Logo"),u=y("option"),E=w("Test Opcode"),k=y("option"),z=w("Maze"),D=y("option"),_=w("Breakout"),S=O(),A=y("div"),K=y("button"),P=w("Reset"),this.h()},l(e){t=$(e,"FIELDSET",{slot:!0});var a=b(t);n=$(a,"DIV",{class:!0});var h=b(n);i=$(h,"LABEL",{for:!0});var g=b(i);l=I(g,"ROM"),g.forEach(f),o=T(h),s=$(h,"SELECT",{id:!0});var m=b(s);r=$(m,"OPTION",{default:!0});var C=b(r);d=I(C,"IBM Logo"),C.forEach(f),u=$(m,"OPTION",{});var F=b(u);E=I(F,"Test Opcode"),F.forEach(f),k=$(m,"OPTION",{});var B=b(k);z=I(B,"Maze"),B.forEach(f),D=$(m,"OPTION",{});var G=b(D);_=I(G,"Breakout"),G.forEach(f),m.forEach(f),h.forEach(f),S=T(a),A=$(a,"DIV",{class:!0});var J=b(A);K=$(J,"BUTTON",{});var Q=b(K);P=I(Q,"Reset"),Q.forEach(f),J.forEach(f),a.forEach(f),this.h()},h(){q(i,"for","rom"),q(r,"default",""),r.__value="/chip8/ibm_logo.ch8",r.value=r.__value,u.__value="/chip8/test_opcode.ch8",u.value=u.__value,k.__value="/chip8/maze.rom",k.value=k.__value,D.__value="/chip8/breakout.rom",D.value=D.__value,q(s,"id","rom"),p[2]===void 0&&ae(()=>p[3].call(s)),q(n,"class","demo-input-group"),q(A,"class","demo-input-group run svelte-nzknsg"),q(t,"slot","controls")},m(e,a){v(e,t,a),x(t,n),x(n,i),x(i,l),x(n,o),x(n,s),x(s,r),x(r,d),x(s,u),x(u,E),x(s,k),x(k,z),x(s,D),x(D,_),X(s,p[2]),x(t,S),x(t,A),x(A,K),x(K,P),M||(c=[W(s,"change",p[3]),W(s,"change",p[4]),W(K,"click",p[5])],M=!0)},p(e,a){a&4&&X(s,e[2])},d(e){e&&f(t),M=!1,re(c)}}}function me(p){let t,n;return t=new pe({props:{id:"container",caption:"CHIP-8 Interpreter",$$slots:{controls:[ue],canvas:[de]},$$scope:{ctx:p}}}),{c(){L(t.$$.fragment)},l(i){R(t.$$.fragment,i)},m(i,l){N(t,i,l),n=!0},p(i,[l]){const o={};l&131079&&(o.$$scope={dirty:l,ctx:i}),t.$set(o)},i(i){n||(H(t.$$.fragment,i),n=!0)},o(i){U(t.$$.fragment,i),n=!1},d(i){V(t,i)}}}const j=64,ke=32;function ge(p,t,n){let i,l,o=0,s=0;const r=[240,144,144,144,240,32,96,32,32,112,240,16,240,128,240,240,16,240,16,240,144,144,240,16,16,240,128,240,16,240,240,128,240,144,240,240,16,32,64,64,240,144,240,144,240,240,144,240,16,240,240,144,240,144,144,224,144,224,144,224,240,128,128,128,240,224,144,144,144,224,240,128,240,128,240,240,128,240,128,128];class d{constructor(){this.ram=null,this.registers=null,this.stack=null,this.display=null,this.keypad=null,this.index=null,this.delay=null,this.sound=null,this.pc=null,this.sp=null,this.opcode=null;const e=h=>{switch(h.code){case"Digit1":this.keypad[1]=1;break;case"Digit2":this.keypad[2]=1;break;case"Digit3":this.keypad[3]=1;break;case"Digit4":this.keypad[12]=1;break;case"KeyQ":this.keypad[4]=1;break;case"KeyW":this.keypad[5]=1;break;case"KeyE":this.keypad[6]=1;break;case"KeyR":this.keypad[13]=1;break;case"KeyA":this.keypad[7]=1;break;case"KeyS":this.keypad[8]=1;break;case"KeyD":this.keypad[9]=1;break;case"KeyF":this.keypad[14]=1;break;case"KeyZ":this.keypad[10]=1;break;case"KeyX":this.keypad[0]=1;break;case"KeyC":this.keypad[11]=1;break;case"KeyV":this.keypad[15]=1;break;default:return}},a=h=>{switch(h.code){case"Digit1":this.keypad[1]=0;break;case"Digit2":this.keypad[2]=0;break;case"Digit3":this.keypad[3]=0;break;case"Digit4":this.keypad[12]=0;break;case"KeyQ":this.keypad[4]=0;break;case"KeyW":this.keypad[5]=0;break;case"KeyE":this.keypad[6]=0;break;case"KeyR":this.keypad[13]=0;break;case"KeyA":this.keypad[7]=0;break;case"KeyS":this.keypad[8]=0;break;case"KeyD":this.keypad[9]=0;break;case"KeyF":this.keypad[14]=0;break;case"KeyZ":this.keypad[10]=0;break;case"KeyX":this.keypad[0]=0;break;case"KeyC":this.keypad[11]=0;break;case"KeyV":this.keypad[15]=0;break;default:return}};window.addEventListener("keydown",e,{passive:!0}),window.addEventListener("keyup",a,{passive:!0})}init(){this.ram=new Uint8Array(4096),this.registers=new Uint8Array(16),this.stack=new Uint16Array(16),this.display=new Uint8Array(64*32),this.keypad=new Uint8Array(16),this.index=0,this.delay=0,this.sound=0,this.pc=512,this.sp=0,this.opcode=0;for(let e=0;e<r.length;e++)this.ram[e+80]=r[e]}async load(e){const h=await(await fetch(e).then(m=>m.blob())).arrayBuffer(),g=new Uint8Array(h);this.init();for(let m=0;m<g.length;m++)this.ram[m+512]=g[m]}cycle(){switch(this.opcode=this.ram[this.pc]<<8|this.ram[this.pc+1],this.pc+=2,this.opcode&61440){case 0:{switch(this.opcode&255){case 224:{for(let a=0;a<this.display.length;a++)this.display[a]=0;break}case 238:{this.sp--,this.pc=this.stack[this.sp];break}}break}case 4096:{this.pc=this.opcode&4095;break}case 8192:{const e=this.opcode&4095;this.stack[this.sp]=this.pc,this.sp++,this.pc=e;break}case 12288:{const e=(this.opcode&3840)>>8,a=this.opcode&255;this.registers[e]===a&&(this.pc+=2);break}case 16384:{const e=(this.opcode&3840)>>8,a=this.opcode&255;this.registers[e]!==a&&(this.pc+=2);break}case 20480:{const e=(this.opcode&3840)>>8,a=(this.opcode&240)>>4;this.registers[e]===this.registers[a]&&(this.pc+=2);break}case 24576:{const e=(this.opcode&3840)>>8,a=this.opcode&255;this.registers[e]=a;break}case 28672:{const e=(this.opcode&3840)>>8,a=this.opcode&255;this.registers[e]+=a;break}case 32768:{const e=(this.opcode&3840)>>8,a=(this.opcode&240)>>4;switch(this.opcode&15){case 0:{this.registers[e]=this.registers[a];break}case 1:{this.registers[e]|=this.registers[a];break}case 2:{this.registers[e]&=this.registers[a];break}case 3:{this.registers[e]^=this.registers[a];break}case 4:{this.registers[e]+this.registers[a]>(1<<8)-1?this.registers[15]=1:this.registers[15]=0,this.registers[e]+=this.registers[a];break}case 5:{this.registers[e]<this.registers[a]?this.registers[15]=0:this.registers[15]=1,this.registers[e]-=this.registers[a];break}case 6:{this.registers[15]=this.registers[e]&1,this.registers[e]>>=1;break}case 7:{this.registers[a]<this.registers[e]?this.registers[15]=0:this.registers[15]=1,this.registers[e]=this.registers[a]-this.registers[e];break}case 14:{this.registers[15]=(this.registers[e]&128)>>7,this.registers[e]<<=1;break}}break}case 36864:{const e=(this.opcode&3840)>>8,a=(this.opcode&240)>>4;this.registers[e]!==this.registers[a]&&(this.pc+=2);break}case 40960:{this.index=this.opcode&4095;break}case 45056:{const e=this.opcode&4095;this.pc=e+this.registers[0];break}case 49152:{const e=(this.opcode&3840)>>8,a=this.opcode&255;this.registers[e]=this.random()&a;break}case 53248:{const e=this.registers[(this.opcode&3840)>>8],a=this.registers[(this.opcode&240)>>4],h=this.opcode&15;this.registers[15]=0;for(let g=0;g<h;g++){const m=this.ram[this.index+g];for(let C=0;C<8;C++){const F=128>>C;if((m&F)!==0){const B=e+C+(a+g)*64;this.display[B]===1&&(this.registers[15]=1),this.display[B]^=1}}}break}case 57344:{const e=(this.opcode&3840)>>8;switch(this.opcode&255){case 158:{this.keypad[this.registers[e]]===1&&(this.pc+=2);break}case 161:{this.keypad[this.registers[e]]===0&&(this.pc+=2);break}}break}case 61440:{const e=(this.opcode&3840)>>8;switch(this.opcode&255){case 7:{this.registers[e]=this.delay;break}case 10:{this.keypad[0]?this.registers[e]=0:this.keypad[1]?this.registers[e]=1:this.keypad[2]?this.registers[e]=2:this.keypad[3]?this.registers[e]=3:this.keypad[4]?this.registers[e]=4:this.keypad[5]?this.registers[e]=5:this.keypad[6]?this.registers[e]=6:this.keypad[7]?this.registers[e]=7:this.keypad[8]?this.registers[e]=8:this.keypad[9]?this.registers[e]=9:this.keypad[10]?this.registers[e]=10:this.keypad[11]?this.registers[e]=11:this.keypad[12]?this.registers[e]=12:this.keypad[13]?this.registers[e]=13:this.keypad[14]?this.registers[e]=14:this.keypad[15]?this.registers[e]=15:this.pc-=2;break}case 21:{this.delay=this.registers[e];break}case 24:{this.sound=this.registers[e];break}case 30:{this.index+=this.registers[e];break}case 41:{const h=80+e*5;this.index=h;break}case 51:{let h=this.registers[e],g=0,m=0,C=0;for(;h-100>=0;)h-=100,g++;for(;h-10>=0;)h-=10,m++;for(;h-1>=0;)h-=1,C++;this.ram[this.index]=g,this.ram[this.index+1]=m,this.ram[this.index+2]=C;break}case 85:{for(let h=0;h<=e;h++)this.ram[this.index+h]=this.registers[h];break}case 101:{for(let h=0;h<=e;h++)this.registers[h]=this.ram[this.index+h];break}}break}}this.delay>0&&this.delay--,this.sound>0&&this.sound--}random(){return Math.floor(Math.random()*256)}}class u{constructor(e){this.canvas=e,this.ctx=this.canvas.getContext("2d")}resize(){this.canvas.width=o,this.canvas.height=s,this.canvas.style.width=`${o}px`,this.canvas.style.height=`${s}px`,this.ctx.clearRect(0,0,o,s),this.imageData=this.ctx.getImageData(0,0,o,s)}draw(e){for(let a=0;a<o;a++)for(let h=0;h<s;h++){const g=Math.floor(a/o*64),m=Math.floor(h/s*32),C=Math.floor(g+m*64),F=e[C]*255,B=Math.floor(a*4+h*o*4);this.imageData.data[B]=F,this.imageData.data[B+1]=F,this.imageData.data[B+2]=F,this.imageData.data[B+3]=255}this.ctx.putImageData(this.imageData,0,0)}}let E,k;const z=1e3/60;let D=0,_="/chip8/ibm_logo.ch8";se(()=>{i=document.getElementById("container");function c(){const e=i.clientWidth;o=j;let a=1;for(;o<=e-j;)o+=j,a++;s=ke*a,k.resize()}return window.addEventListener("resize",c,{passive:!0}),n(1,E=new d),k=new u(l),E.load(_).then(()=>{c(),S()}),()=>{window.removeEventListener("resize",c)}});function S(c=0){c-D>z&&(E.cycle(),k.draw(E.display),D=c),window.requestAnimationFrame(S)}function A(){_=oe(this),n(2,_)}const K=()=>{E.load(_)},P=()=>E.load(_);function M(c){ne[c?"unshift":"push"](()=>{l=c,n(0,l)})}return[l,E,_,A,K,P,M]}class ye extends Y{constructor(t){super(),ee(this,t,ge,me,te,{})}}function $e(p){let t;return{c(){t=w("CHIP-8 Interpreter")},l(n){t=I(n,"CHIP-8 Interpreter")},m(n,i){v(n,t,i)},d(n){n&&f(t)}}}function be(p){let t,n,i,l,o;return t=new fe({props:{timestamp:1655577363,$$slots:{default:[$e]},$$scope:{ctx:p}}}),{c(){L(t.$$.fragment),n=O(),i=y("p"),l=w("I wanted to code a NES emulator but here we are.")},l(s){R(t.$$.fragment,s),n=T(s),i=$(s,"P",{});var r=b(i);l=I(r,"I wanted to code a NES emulator but here we are."),r.forEach(f)},m(s,r){N(t,s,r),v(s,n,r),v(s,i,r),x(i,l),o=!0},p(s,r){const d={};r&1&&(d.$$scope={dirty:r,ctx:s}),t.$set(d)},i(s){o||(H(t.$$.fragment,s),o=!0)},o(s){U(t.$$.fragment,s),o=!1},d(s){V(t,s),s&&f(n),s&&f(i)}}}function _e(p){let t;return{c(){t=w("Demo")},l(n){t=I(n,"Demo")},m(n,i){v(n,t,i)},d(n){n&&f(t)}}}function ve(p){let t,n,i,l,o,s,r,d,u,E,k,z,D,_,S,A,K,P,M;return t=new le({props:{id:"demo",$$slots:{default:[_e]},$$scope:{ctx:p}}}),P=new ye({}),{c(){L(t.$$.fragment),n=O(),i=y("p"),l=w(`It's my first time coding an emulator/interpreter. I've heard that
			this is a very common starter project for people who want to try
			their hands at something more complex like a NES or a GBA maybe.`),o=O(),s=y("p"),r=w("Didn't implement audio."),d=O(),u=y("p"),E=w("Breakout demo: use "),k=y("var"),z=w("q"),D=w(" and "),_=y("var"),S=w("e"),A=w(" to move."),K=O(),L(P.$$.fragment)},l(c){R(t.$$.fragment,c),n=T(c),i=$(c,"P",{});var e=b(i);l=I(e,`It's my first time coding an emulator/interpreter. I've heard that
			this is a very common starter project for people who want to try
			their hands at something more complex like a NES or a GBA maybe.`),e.forEach(f),o=T(c),s=$(c,"P",{});var a=b(s);r=I(a,"Didn't implement audio."),a.forEach(f),d=T(c),u=$(c,"P",{});var h=b(u);E=I(h,"Breakout demo: use "),k=$(h,"VAR",{});var g=b(k);z=I(g,"q"),g.forEach(f),D=I(h," and "),_=$(h,"VAR",{});var m=b(_);S=I(m,"e"),m.forEach(f),A=I(h," to move."),h.forEach(f),K=T(c),R(P.$$.fragment,c)},m(c,e){N(t,c,e),v(c,n,e),v(c,i,e),x(i,l),v(c,o,e),v(c,s,e),x(s,r),v(c,d,e),v(c,u,e),x(u,E),x(u,k),x(k,z),x(u,D),x(u,_),x(_,S),x(u,A),v(c,K,e),N(P,c,e),M=!0},p(c,e){const a={};e&1&&(a.$$scope={dirty:e,ctx:c}),t.$set(a)},i(c){M||(H(t.$$.fragment,c),H(P.$$.fragment,c),M=!0)},o(c){U(t.$$.fragment,c),U(P.$$.fragment,c),M=!1},d(c){V(t,c),c&&f(n),c&&f(i),c&&f(o),c&&f(s),c&&f(d),c&&f(u),c&&f(K),V(P,c)}}}function we(p){let t,n,i,l;return t=new Z({props:{$$slots:{default:[be]},$$scope:{ctx:p}}}),i=new Z({props:{$$slots:{default:[ve]},$$scope:{ctx:p}}}),{c(){L(t.$$.fragment),n=O(),L(i.$$.fragment)},l(o){R(t.$$.fragment,o),n=T(o),R(i.$$.fragment,o)},m(o,s){N(t,o,s),v(o,n,s),N(i,o,s),l=!0},p(o,s){const r={};s&1&&(r.$$scope={dirty:s,ctx:o}),t.$set(r);const d={};s&1&&(d.$$scope={dirty:s,ctx:o}),i.$set(d)},i(o){l||(H(t.$$.fragment,o),H(i.$$.fragment,o),l=!0)},o(o){U(t.$$.fragment,o),U(i.$$.fragment,o),l=!1},d(o){V(t,o),o&&f(n),V(i,o)}}}function Ie(p){let t,n,i,l,o,s;return t=new xe({props:{title:"CHIP-8 Interpreter",description:"Javascript CHIP-8 Interpreter",keywords:"CHIP-8, Javascript, Emulator, Interpreter"}}),i=new ce({props:{$$slots:{default:[we]},$$scope:{ctx:p}}}),o=new he({}),{c(){L(t.$$.fragment),n=O(),L(i.$$.fragment),l=O(),L(o.$$.fragment)},l(r){R(t.$$.fragment,r),n=T(r),R(i.$$.fragment,r),l=T(r),R(o.$$.fragment,r)},m(r,d){N(t,r,d),v(r,n,d),N(i,r,d),v(r,l,d),N(o,r,d),s=!0},p(r,[d]){const u={};d&1&&(u.$$scope={dirty:d,ctx:r}),i.$set(u)},i(r){s||(H(t.$$.fragment,r),H(i.$$.fragment,r),H(o.$$.fragment,r),s=!0)},o(r){U(t.$$.fragment,r),U(i.$$.fragment,r),U(o.$$.fragment,r),s=!1},d(r){V(t,r),r&&f(n),V(i,r),r&&f(l),V(o,r)}}}class Ae extends Y{constructor(t){super(),ee(this,t,null,Ie,te,{})}}export{Ae as default};
